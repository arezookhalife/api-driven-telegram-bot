<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API Driven Telegram Bot</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >
</head>
<body class="bg-light">

<div class="container py-5">

    <h1 class="mb-3">API-Driven Telegram Bot</h1>
    <p class="text-muted">
        A professional Telegram bot built with <strong>Aiogram</strong> and
        <strong>Django REST API</strong>.
    </p>

    <hr>

    <h4>Live Demo</h4>
    <p>
        Telegram Bot:
        <a href="{{ bot_link }}" target="_blank">
            Open Bot
        </a>
    </p>

    <hr>

    <h4>Test the Bot (Web Interface)</h4>

    <form id="test-form" class="mb-3">
        <input
            type="text"
            id="message"
            class="form-control mb-2"
            placeholder="Type your message..."
            required
        >
        <button class="btn btn-primary">Send</button>
    </form>

    <div id="response" class="alert alert-secondary d-none"></div>

</div>

<script>
document.getElementById("test-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const message = document.getElementById("message").value;
    const responseBox = document.getElementById("response");
    
    const payload = {
        user_id: 1,            
        username: "web_user", 
        message: message
    };

    try {
        const res = await fetch("/api/reply/", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(payload)
        });

        const data = await res.json();

        responseBox.classList.remove("d-none");
        responseBox.innerText = data.reply || data.error;
    
    } catch (err) {
        responseBox.classList.remove("d-none");
        responseBox.innerText = "Error: " + err.message;
    }

});
</script>

</body>
</html>
